// SPDX-License-Identifier: PMPL-1.0-or-later
= Conformance Example: API to Database

== Purpose

This document demonstrates correct usage of the API to Database boundary.

== Correct Usage

.Using repository pattern
[source,rust]
----
// Correct: API handler uses repository
async fn get_user(repo: &UserRepository, id: UserId) -> Result<User> {
    repo.find_by_id(id).await
}
----

== Anti-Patterns

.Direct SQL in handler
[source,rust]
----
// WRONG: Direct SQL access bypasses the seam
async fn get_user(pool: &PgPool, id: i64) -> Result<User> {
    sqlx::query_as("SELECT * FROM users WHERE id = $1")
        .bind(id)
        .fetch_one(pool)
        .await
}
----
